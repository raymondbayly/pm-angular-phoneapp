/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { LocationsConfigService } from '../config/locations-config.service';
import { Subject } from 'rxjs';
import { map } from 'rxjs/operators';
import { Locations } from '../../../model/Locations';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common/http";
import * as i2 from "../config/locations-config.service";
export class LocationsApiService {
    /**
     * @param {?} http
     * @param {?} locationsConfigService
     */
    constructor(http, locationsConfigService) {
        this.http = http;
        this.locationsConfigService = locationsConfigService;
        this.locations = new Locations();
        this.facilitiesAndUnit$ = new Subject();
    }
    /**
     * Updates facilities and units and calls the facilitiesAndUnitSubject when it completes.
     * Will use a cache if they were previously retrieved.
     * @return {?}
     */
    getFacilitiesAndUnits() {
        if (this.locations.facilities && this.locations.facilities.length > 0 && this.locations.units && this.locations.units.length > 0) {
            this.facilitiesAndUnit$.next(this.locations);
        }
        else {
            /** Receive all facilities and active units and set instance variables for caching */
            this.facilitySubscription = this.getActiveFacilities().pipe(map((f) => f.facilities)).subscribe((facilities) => {
                if (facilities && facilities.length > 0) {
                    /** @type {?} */
                    const facilityIds = [];
                    for (const facility of facilities) {
                        facilityIds.push(facility.facilityID);
                    }
                    this.unitSubscription = this.getActiveUnitsForFacilities(facilityIds).pipe((map((u) => u.units))).subscribe((units) => {
                        // filter out facilities with no active units
                        this.locations = new Locations();
                        for (const f of facilities) {
                            /** @type {?} */
                            let hasActiveUnits = false;
                            for (const u of units) {
                                if (u.key.facilityID === f.facilityID) {
                                    hasActiveUnits = true;
                                    break;
                                }
                            }
                            if (hasActiveUnits) {
                                this.locations.facilities.push(f);
                            }
                        }
                        this.locations.units = units;
                        this.facilitiesAndUnit$.next(this.locations);
                    }, (e) => {
                        console.log('Could not update units! Error = ' + e.message);
                    });
                }
            }, (e) => {
                console.log('Could not update facilities! Error = ' + e.message);
            });
        }
    }
    /**
     * @return {?}
     */
    getActiveFacilities() {
        console.log('Getting all facilities: ' + this.locationsConfigService.getActiveFacilitiesEndpoint());
        return this.http.get(this.locationsConfigService.getActiveFacilitiesEndpoint());
    }
    /**
     * @param {?} facilities
     * @return {?}
     */
    getActiveUnitsForFacilities(facilities) {
        console.log('Getting all active units: ' + this.locationsConfigService.getActiveUnitsEndpoint() + facilities);
        return this.http.get(this.locationsConfigService.getActiveUnitsEndpoint() + facilities);
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (this.facilitySubscription && !this.facilitySubscription.closed) {
            this.facilitySubscription.unsubscribe();
        }
        if (this.unitSubscription && !this.unitSubscription.closed) {
            this.unitSubscription.unsubscribe();
        }
    }
}
LocationsApiService.decorators = [
    { type: Injectable, args: [{
                providedIn: 'root'
            },] }
];
/** @nocollapse */
LocationsApiService.ctorParameters = () => [
    { type: HttpClient },
    { type: LocationsConfigService }
];
/** @nocollapse */ LocationsApiService.ngInjectableDef = i0.defineInjectable({ factory: function LocationsApiService_Factory() { return new LocationsApiService(i0.inject(i1.HttpClient), i0.inject(i2.LocationsConfigService)); }, token: LocationsApiService, providedIn: "root" });
if (false) {
    /** @type {?} */
    LocationsApiService.prototype.facilitySubscription;
    /** @type {?} */
    LocationsApiService.prototype.unitSubscription;
    /** @type {?} */
    LocationsApiService.prototype.facilitiesAndUnit$;
    /** @type {?} */
    LocationsApiService.prototype.locations;
    /** @type {?} */
    LocationsApiService.prototype.http;
    /** @type {?} */
    LocationsApiService.prototype.locationsConfigService;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9jYXRpb25zLWFwaS5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vbmctY29tbW9uLWxpYnJhcnkvIiwic291cmNlcyI6WyJsaWIvc2VydmljZS9sb2NhdGlvbnMvYXBpL2xvY2F0aW9ucy1hcGkuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFDLFVBQVUsRUFBWSxNQUFNLGVBQWUsQ0FBQztBQUdwRCxPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0sc0JBQXNCLENBQUM7QUFDaEQsT0FBTyxFQUFDLHNCQUFzQixFQUFDLE1BQU0sb0NBQW9DLENBQUM7QUFDMUUsT0FBTyxFQUFhLE9BQU8sRUFBZSxNQUFNLE1BQU0sQ0FBQztBQUN2RCxPQUFPLEVBQUMsR0FBRyxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFDbkMsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLDBCQUEwQixDQUFDOzs7O0FBS25ELE1BQU07Ozs7O0lBU0osWUFDVSxNQUNBO1FBREEsU0FBSSxHQUFKLElBQUk7UUFDSiwyQkFBc0IsR0FBdEIsc0JBQXNCO3lCQUpELElBQUksU0FBUyxFQUFFO1FBSzVDLElBQUksQ0FBQyxrQkFBa0IsR0FBRyxJQUFJLE9BQU8sRUFBNkMsQ0FBQztLQUNwRjs7Ozs7O0lBTU0scUJBQXFCO1FBQzFCLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLE1BQU0sR0FBRyxDQUFDLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDakksSUFBSSxDQUFDLGtCQUFrQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7U0FDOUM7UUFBQyxJQUFJLENBQUMsQ0FBQzs7WUFFTixJQUFJLENBQUMsb0JBQW9CLEdBQUcsSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsVUFBc0IsRUFBRSxFQUFFO2dCQUN6SCxFQUFFLENBQUMsQ0FBQyxVQUFVLElBQUksVUFBVSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDOztvQkFDeEMsTUFBTSxXQUFXLEdBQWEsRUFBRSxDQUFDO29CQUNqQyxHQUFHLENBQUMsQ0FBQyxNQUFNLFFBQVEsSUFBSSxVQUFVLENBQUMsQ0FBQyxDQUFDO3dCQUNsQyxXQUFXLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsQ0FBQztxQkFDdkM7b0JBQ0QsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQywyQkFBMkIsQ0FBQyxXQUFXLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsS0FBYSxFQUFFLEVBQUU7O3dCQUU1SCxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksU0FBUyxFQUFFLENBQUM7d0JBQ2pDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLFVBQVUsQ0FBQyxDQUFDLENBQUM7OzRCQUMzQixJQUFJLGNBQWMsR0FBRyxLQUFLLENBQUM7NEJBQzNCLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUM7Z0NBQ3RCLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBVSxLQUFLLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO29DQUN0QyxjQUFjLEdBQUcsSUFBSSxDQUFDO29DQUN0QixLQUFLLENBQUM7aUNBQ1A7NkJBQ0Y7NEJBQ0QsRUFBRSxDQUFDLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQztnQ0FDbkIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDOzZCQUNuQzt5QkFDRjt3QkFDRCxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7d0JBQzdCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO3FCQUM5QyxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUU7d0JBQ1AsT0FBTyxDQUFDLEdBQUcsQ0FBQyxrQ0FBa0MsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUM7cUJBQzdELENBQUMsQ0FBQztpQkFDSjthQUNGLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRTtnQkFDUCxPQUFPLENBQUMsR0FBRyxDQUFDLHVDQUF1QyxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQzthQUNsRSxDQUFDLENBQUM7U0FDSjs7Ozs7SUFHSCxtQkFBbUI7UUFDakIsT0FBTyxDQUFDLEdBQUcsQ0FBQywwQkFBMEIsR0FBRyxJQUFJLENBQUMsc0JBQXNCLENBQUMsMkJBQTJCLEVBQUUsQ0FBQyxDQUFDO1FBQ3BHLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBa0MsSUFBSSxDQUFDLHNCQUFzQixDQUFDLDJCQUEyQixFQUFFLENBQUMsQ0FBQztLQUNsSDs7Ozs7SUFFRCwyQkFBMkIsQ0FBQyxVQUFvQjtRQUM5QyxPQUFPLENBQUMsR0FBRyxDQUFDLDRCQUE0QixHQUFHLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLFVBQVUsQ0FBQyxDQUFDO1FBQzlHLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBeUIsSUFBSSxDQUFDLHNCQUFzQixDQUFDLHNCQUFzQixFQUFFLEdBQUcsVUFBVSxDQUFDLENBQUM7S0FDakg7Ozs7SUFFRCxXQUFXO1FBQ1QsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLG9CQUFvQixJQUFJLENBQUMsSUFBSSxDQUFDLG9CQUFvQixDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7WUFDbkUsSUFBSSxDQUFDLG9CQUFvQixDQUFDLFdBQVcsRUFBRSxDQUFDO1NBQ3pDO1FBQ0QsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFnQixJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7WUFDM0QsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFdBQVcsRUFBRSxDQUFDO1NBQ3JDO0tBQ0Y7OztZQTdFRixVQUFVLFNBQUM7Z0JBQ1YsVUFBVSxFQUFFLE1BQU07YUFDbkI7Ozs7WUFSTyxVQUFVO1lBQ1Ysc0JBQXNCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtJbmplY3RhYmxlLCBPbkRlc3Ryb3l9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtVbml0fSBmcm9tICcuLi8uLi8uLi9tb2RlbC9Vbml0JztcbmltcG9ydCB7RmFjaWxpdHl9IGZyb20gJy4uLy4uLy4uL21vZGVsL0ZhY2lsaXR5JztcbmltcG9ydCB7SHR0cENsaWVudH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHtMb2NhdGlvbnNDb25maWdTZXJ2aWNlfSBmcm9tICcuLi9jb25maWcvbG9jYXRpb25zLWNvbmZpZy5zZXJ2aWNlJztcbmltcG9ydCB7T2JzZXJ2YWJsZSwgU3ViamVjdCwgU3Vic2NyaXB0aW9ufSBmcm9tICdyeGpzJztcbmltcG9ydCB7bWFwfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQge0xvY2F0aW9uc30gZnJvbSAnLi4vLi4vLi4vbW9kZWwvTG9jYXRpb25zJztcblxuQEluamVjdGFibGUoe1xuICBwcm92aWRlZEluOiAncm9vdCdcbn0pXG5leHBvcnQgY2xhc3MgTG9jYXRpb25zQXBpU2VydmljZSBpbXBsZW1lbnRzIE9uRGVzdHJveSB7XG5cbiAgcHJpdmF0ZSBmYWNpbGl0eVN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuICBwcml2YXRlIHVuaXRTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcblxuICBwdWJsaWMgcmVhZG9ubHkgZmFjaWxpdGllc0FuZFVuaXQkOiBTdWJqZWN0PHsgZmFjaWxpdGllczogRmFjaWxpdHlbXSwgdW5pdHM6IFVuaXRbXSB9PjtcblxuICBwcml2YXRlIGxvY2F0aW9uczogTG9jYXRpb25zID0gbmV3IExvY2F0aW9ucygpO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgaHR0cDogSHR0cENsaWVudCxcbiAgICBwcml2YXRlIGxvY2F0aW9uc0NvbmZpZ1NlcnZpY2U6IExvY2F0aW9uc0NvbmZpZ1NlcnZpY2UpIHtcbiAgICB0aGlzLmZhY2lsaXRpZXNBbmRVbml0JCA9IG5ldyBTdWJqZWN0PHsgZmFjaWxpdGllczogRmFjaWxpdHlbXSwgdW5pdHM6IFVuaXRbXSB9PigpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgZmFjaWxpdGllcyBhbmQgdW5pdHMgYW5kIGNhbGxzIHRoZSBmYWNpbGl0aWVzQW5kVW5pdFN1YmplY3Qgd2hlbiBpdCBjb21wbGV0ZXMuXG4gICAqIFdpbGwgdXNlIGEgY2FjaGUgaWYgdGhleSB3ZXJlIHByZXZpb3VzbHkgcmV0cmlldmVkLlxuICAgKi9cbiAgcHVibGljIGdldEZhY2lsaXRpZXNBbmRVbml0cygpIHtcbiAgICBpZiAodGhpcy5sb2NhdGlvbnMuZmFjaWxpdGllcyAmJiB0aGlzLmxvY2F0aW9ucy5mYWNpbGl0aWVzLmxlbmd0aCA+IDAgJiYgdGhpcy5sb2NhdGlvbnMudW5pdHMgJiYgdGhpcy5sb2NhdGlvbnMudW5pdHMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5mYWNpbGl0aWVzQW5kVW5pdCQubmV4dCh0aGlzLmxvY2F0aW9ucyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8qKiBSZWNlaXZlIGFsbCBmYWNpbGl0aWVzIGFuZCBhY3RpdmUgdW5pdHMgYW5kIHNldCBpbnN0YW5jZSB2YXJpYWJsZXMgZm9yIGNhY2hpbmcgKi9cbiAgICAgIHRoaXMuZmFjaWxpdHlTdWJzY3JpcHRpb24gPSB0aGlzLmdldEFjdGl2ZUZhY2lsaXRpZXMoKS5waXBlKG1hcCgoZikgPT4gZi5mYWNpbGl0aWVzKSkuc3Vic2NyaWJlKChmYWNpbGl0aWVzOiBGYWNpbGl0eVtdKSA9PiB7XG4gICAgICAgIGlmIChmYWNpbGl0aWVzICYmIGZhY2lsaXRpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnN0IGZhY2lsaXR5SWRzOiBTdHJpbmdbXSA9IFtdO1xuICAgICAgICAgIGZvciAoY29uc3QgZmFjaWxpdHkgb2YgZmFjaWxpdGllcykge1xuICAgICAgICAgICAgZmFjaWxpdHlJZHMucHVzaChmYWNpbGl0eS5mYWNpbGl0eUlEKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy51bml0U3Vic2NyaXB0aW9uID0gdGhpcy5nZXRBY3RpdmVVbml0c0ZvckZhY2lsaXRpZXMoZmFjaWxpdHlJZHMpLnBpcGUoKG1hcCgodSkgPT4gdS51bml0cykpKS5zdWJzY3JpYmUoKHVuaXRzOiBVbml0W10pID0+IHtcbiAgICAgICAgICAgIC8vIGZpbHRlciBvdXQgZmFjaWxpdGllcyB3aXRoIG5vIGFjdGl2ZSB1bml0c1xuICAgICAgICAgICAgdGhpcy5sb2NhdGlvbnMgPSBuZXcgTG9jYXRpb25zKCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGYgb2YgZmFjaWxpdGllcykge1xuICAgICAgICAgICAgICBsZXQgaGFzQWN0aXZlVW5pdHMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgZm9yIChjb25zdCB1IG9mIHVuaXRzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHUua2V5LmZhY2lsaXR5SUQgPT09IGYuZmFjaWxpdHlJRCkge1xuICAgICAgICAgICAgICAgICAgaGFzQWN0aXZlVW5pdHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGlmIChoYXNBY3RpdmVVbml0cykge1xuICAgICAgICAgICAgICAgIHRoaXMubG9jYXRpb25zLmZhY2lsaXRpZXMucHVzaChmKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5sb2NhdGlvbnMudW5pdHMgPSB1bml0cztcbiAgICAgICAgICAgIHRoaXMuZmFjaWxpdGllc0FuZFVuaXQkLm5leHQodGhpcy5sb2NhdGlvbnMpO1xuICAgICAgICAgIH0sIChlKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnQ291bGQgbm90IHVwZGF0ZSB1bml0cyEgRXJyb3IgPSAnICsgZS5tZXNzYWdlKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSwgKGUpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ0NvdWxkIG5vdCB1cGRhdGUgZmFjaWxpdGllcyEgRXJyb3IgPSAnICsgZS5tZXNzYWdlKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGdldEFjdGl2ZUZhY2lsaXRpZXMoKTogT2JzZXJ2YWJsZTx7IGZhY2lsaXRpZXM6IEFycmF5PEZhY2lsaXR5PiB9PiB7XG4gICAgY29uc29sZS5sb2coJ0dldHRpbmcgYWxsIGZhY2lsaXRpZXM6ICcgKyB0aGlzLmxvY2F0aW9uc0NvbmZpZ1NlcnZpY2UuZ2V0QWN0aXZlRmFjaWxpdGllc0VuZHBvaW50KCkpO1xuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0PHsgZmFjaWxpdGllczogQXJyYXk8RmFjaWxpdHk+IH0+KHRoaXMubG9jYXRpb25zQ29uZmlnU2VydmljZS5nZXRBY3RpdmVGYWNpbGl0aWVzRW5kcG9pbnQoKSk7XG4gIH1cblxuICBnZXRBY3RpdmVVbml0c0ZvckZhY2lsaXRpZXMoZmFjaWxpdGllczogU3RyaW5nW10pOiBPYnNlcnZhYmxlPHsgdW5pdHM6IEFycmF5PFVuaXQ+IH0+IHtcbiAgICBjb25zb2xlLmxvZygnR2V0dGluZyBhbGwgYWN0aXZlIHVuaXRzOiAnICsgdGhpcy5sb2NhdGlvbnNDb25maWdTZXJ2aWNlLmdldEFjdGl2ZVVuaXRzRW5kcG9pbnQoKSArIGZhY2lsaXRpZXMpO1xuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0PHsgdW5pdHM6IEFycmF5PFVuaXQ+IH0+KHRoaXMubG9jYXRpb25zQ29uZmlnU2VydmljZS5nZXRBY3RpdmVVbml0c0VuZHBvaW50KCkgKyBmYWNpbGl0aWVzKTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmZhY2lsaXR5U3Vic2NyaXB0aW9uICYmICF0aGlzLmZhY2lsaXR5U3Vic2NyaXB0aW9uLmNsb3NlZCkge1xuICAgICAgdGhpcy5mYWNpbGl0eVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgIH1cbiAgICBpZiAodGhpcy51bml0U3Vic2NyaXB0aW9uICYmICF0aGlzLnVuaXRTdWJzY3JpcHRpb24uY2xvc2VkKSB7XG4gICAgICB0aGlzLnVuaXRTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==