{"version":3,"file":"ng-common-library.js.map","sources":["ng://ng-common-library/lib/service/browser.service.ts","ng://ng-common-library/lib/model/MarkerColors.ts","ng://ng-common-library/lib/service/date.service.ts","ng://ng-common-library/lib/service/chart.service.ts","ng://ng-common-library/lib/service/warning.service.ts","ng://ng-common-library/lib/service/flowsheets/config/flowsheets-config.service.ts","ng://ng-common-library/lib/service/flowsheets/api/flowsheets-api.service.ts","ng://ng-common-library/lib/service/peragraph/config/peragraph-config.service.ts","ng://ng-common-library/lib/service/peragraph/api/peragraph-api.service.ts","ng://ng-common-library/lib/service/patient.service.ts","ng://ng-common-library/lib/service/common.service.ts","ng://ng-common-library/lib/service/translations/translations.service.ts","ng://ng-common-library/lib/service/translations/config/translations-config.service.ts","ng://ng-common-library/lib/service/translations/api/translations-api.service.ts","ng://ng-common-library/lib/service/diagnosis/config/diagnosis-config.service.ts","ng://ng-common-library/lib/service/diagnosis/api/diagnosis-api.service.ts","ng://ng-common-library/lib/service/token/config/token-config.service.ts","ng://ng-common-library/lib/model/User.ts","ng://ng-common-library/lib/service/token/api/token-api.service.ts","ng://ng-common-library/lib/service/locations/config/locations-config.service.ts","ng://ng-common-library/lib/model/Locations.ts","ng://ng-common-library/lib/service/locations/api/locations-api.service.ts","ng://ng-common-library/lib/service/usage/config/usage-config.service.ts","ng://ng-common-library/lib/model/PatientAccess.ts","ng://ng-common-library/lib/model/UsageType.ts","ng://ng-common-library/lib/service/usage/api/usage-api.service.ts","ng://ng-common-library/lib/model/Facility.ts","ng://ng-common-library/lib/model/Unit.ts","ng://ng-common-library/lib/model/UnitKey.ts"],"sourcesContent":["import {Injectable} from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class BrowserService {\n\n  constructor() {\n  }\n\n  /**\n   * Triggers a browser resize event - needed for the Highchart to resize properly - takes into account the browser type too\n   */\n  public resize() {\n    if (navigator.userAgent.indexOf('MSIE') !== -1 || navigator.appVersion.indexOf('Trident/') > 0) {\n      const evt = document.createEvent('UIEvents');\n      evt.initUIEvent('resize', true, false, window, 0);\n      window.dispatchEvent(evt);\n    } else {\n      window.dispatchEvent(new Event('resize'));\n    }\n  }\n}\n","export enum MarkerColors {\n  Normal = 'black',\n  IntensiveCare = '#F23A27',\n  StepDown= 'blue'\n}\n","import {Injectable} from '@angular/core';\nimport * as moment_ from 'moment-timezone';\n\n// The JavaScript compiler gives a weird \"moment cannot be used as a namespace\" type of error\n// This is the workaround...\nconst moment = moment_;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DateService {\n  /**\n   * Formats the date to be displayed based on the parameters provided\n   * @param dateMil The date/time in milliseconds\n   * @param timeZone Each PeraGraph has one. Just pass it as a parameter.\n   * @param formatString A string param that defines the format in which the date needs to be displayed. e.g : MM/DD/YY HH:mm z\n   */\n  public getDateFormat(timeZone: string, dateMil: number, formatString: string) {\n    return moment(dateMil).utc().tz(timeZone).format(formatString);\n  }\n\n  /**\n   * Translate a date from a UTC offset.\n   *\n   * @param date The date to translate.\n   * @param timezone The timezone that the date was originally created in.\n   */\n  public translateDate(date: number, timezone: string) {\n    return date + ((3600000 / 60) * moment(date).tz(timezone).utcOffset());\n  }\n}\n","import {Injectable} from '@angular/core';\nimport {PeraGraph} from '../model/PeraGraph';\nimport {MarkerColors} from '../model/MarkerColors';\nimport {DateService} from './date.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ChartService {\n\n  constructor(private dateService: DateService) {\n  }\n\n  /**\n   * Create the line across the 0 axis for when RI scores go below zero in a graph.\n   * @param minRiScore Minimum RI score.\n   */\n  public createZeroAxisLine(minRiScore: number) {\n    return [\n      {\n        color: '#000000',\n        width: minRiScore < 0 ? 1 : null,\n        value: minRiScore < 0 ? 0 : null,\n        zIndex: 3\n      }];\n  }\n\n  /**\n   * Create an alert plot line for a graph.\n   *\n   * @param alertCreatedDate The created date of the alert.\n   * @param timeZone The timezone that the alert was created in.\n   */\n  public updateAlertPlotLine(graph: PeraGraph) {\n    const plotLines = [];\n    if (graph && graph.activeWarning) {\n      plotLines.push({\n        color: '#CE2029',\n        value: this.dateService.translateDate(graph.activeWarning.createdDate, graph.timeZone),\n        width: 2,\n        zIndex: 3\n      });\n    }\n    return plotLines;\n  }\n\n  public getMinYAxisTick(minRiScore): number {\n    return (minRiScore > 0) ? 0 : 20 * Math.floor(minRiScore / 20);\n  }\n\n  /**\n   * Used in the graph to depict the unit type where a health score was recorded.\n   * @param unitType Type of unit to get the marker color for.\n   */\n  public getMarkerColor(unitType: string): string {\n    let markerColor = MarkerColors.Normal;\n    switch (unitType) {\n      case 'N':\n        markerColor = MarkerColors.IntensiveCare;\n        break;\n      case 'C':\n        markerColor = MarkerColors.IntensiveCare;\n        break;\n      case 'P':\n        markerColor = MarkerColors.StepDown;\n        break;\n    }\n    return markerColor;\n  }\n}\n","import {Injectable} from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class WarningService {\n\n  constructor() {\n  }\n\n  /**\n   * Returns the correct warning color CSS class\n   *\n   * @param warning Warning category\n   */\n  public getWarningClass(warning: string): string {\n    let warningClass: string = null;\n    switch (warning) {\n      case 'V':\n        warningClass = 'vh-warning';\n        break;\n      case 'H':\n        warningClass = 'h-warning';\n        break;\n      case 'M':\n        warningClass = 'm-warning';\n        break;\n      default:\n        break;\n    }\n    return warningClass;\n  }\n\n}\n","import {Injectable} from '@angular/core';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class FlowsheetsConfigService {\n\n    private singlePeraGraphFlowSheetEndPoint: string = null;\n    private allPeragraphFlowSheetsEndPoint: string = null;\n    private detailedFlowSheetColumnEndpoint: string = null;\n    private latestRiScoresEndPoint: string = null;\n\n    setSinglePeraGraphFlowSheetEndPoint(value: string): void {\n        this.singlePeraGraphFlowSheetEndPoint = value;\n    }\n\n    getSinglePeraGraphFlowSheetEndPoint(): string {\n        if (!this.singlePeraGraphFlowSheetEndPoint) {\n            console.warn('Single PeraGraph flowsheet endpoint is not set!');\n        }\n        return this.singlePeraGraphFlowSheetEndPoint;\n    }\n\n    setAllPeragraphFlowSheetsEndPoint(value: string): void {\n        this.allPeragraphFlowSheetsEndPoint = value;\n    }\n\n    getAllPeragraphFlowSheetsEndPoint(): string {\n        if (!this.allPeragraphFlowSheetsEndPoint) {\n            console.warn('All PeraGraph flowsheets endpoint is not set!');\n        }\n        return this.allPeragraphFlowSheetsEndPoint;\n    }\n\n    setDetailedFlowSheetColumnEndpoint(value: string): void {\n        this.detailedFlowSheetColumnEndpoint = value;\n    }\n\n    getDetailedFlowSheetColumnEndpoint(): string {\n        if (!this.detailedFlowSheetColumnEndpoint) {\n            console.warn('Detailed flowsheet column endpoint is not set!');\n        }\n        return this.detailedFlowSheetColumnEndpoint;\n    }\n\n    setLatestRiScoresEndPoint(value: string): void {\n        this.latestRiScoresEndPoint = value;\n    }\n\n    getLatestRiScoresEndPoint(): string {\n        if (!this.latestRiScoresEndPoint) {\n            console.warn('Latest RI Scores endpoint is not set!');\n        }\n        return this.latestRiScoresEndPoint;\n    }\n}\n","import {Injectable} from '@angular/core';\nimport {HttpClient} from '@angular/common/http';\nimport {FlowsheetsConfigService} from '../config/flowsheets-config.service';\nimport {BehaviorSubject, Observable, timer} from 'rxjs';\nimport {FlowSheetBase} from '../../../model/FlowSheetBase';\nimport {switchMap} from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class FlowsheetsApiService {\n\n  private readonly flowSheetSubject: BehaviorSubject<Map<number, Array<FlowSheetBase>>>;\n  // Map of numeric RI score keyed by Visit ID\n  private readonly riScoresSubject: BehaviorSubject<Map<number, number>>;\n  // The timer that fires so that clients can get the latest flowsheet and RI score values\n  private pollInstance$: Observable<any>;\n\n  constructor(private http: HttpClient,\n              private flowsheetConfigService: FlowsheetsConfigService) {\n    this.pollInstance$ = timer(0, 60000);\n    this.flowSheetSubject = new BehaviorSubject<Map<number, Array<FlowSheetBase>>>(null);\n    this.riScoresSubject = new BehaviorSubject<Map<number, number>>(null);\n  }\n\n  public getFlowSheetSubject() {\n    return this.flowSheetSubject;\n  }\n\n  public getFlowSheetSubjectValue() {\n    return this.flowSheetSubject.value;\n  }\n\n  public getRiScoresSubject() {\n    return this.riScoresSubject;\n  }\n\n  public getRiScoresSubjectValue() {\n    return this.riScoresSubject.value;\n  }\n\n  getSinglePeraGraphFlowSheet(): Observable<any> {\n    return this.http.get<any>(this.flowsheetConfigService.getSinglePeraGraphFlowSheetEndPoint());\n  }\n\n  getDetailedFlowsheetColumn(): Observable<any> {\n    return this.http.get<any>(this.flowsheetConfigService.getDetailedFlowSheetColumnEndpoint());\n  }\n\n  getAllPeraGraphFlowSheets(): Observable<any> {\n    return this.http.get(this.flowsheetConfigService.getAllPeragraphFlowSheetsEndPoint(), {observe: 'response'});\n  }\n\n  getAllRiScores(): Observable<any> {\n    return this.http.get(this.flowsheetConfigService.getLatestRiScoresEndPoint(), {observe: 'response'});\n  }\n\n  public getFlowSheetInterval() {\n    // Make an HTTP call on an interval\n    return this.pollInstance$.pipe(\n      switchMap(() => this.getAllPeraGraphFlowSheets())\n    );\n  }\n\n  public getLatestRiScoresInterval() {\n    // Make an HTTP call on an interval\n    return this.pollInstance$.pipe(\n      switchMap(() => this.getAllRiScores())\n    );\n  }\n}\n","import {Injectable} from '@angular/core';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class PeragraphConfigService {\n\n    private singlePeraGraphEndPoint: string = null;\n    private allPeraGraphsEndPoint: string = null;\n\n    public setSinglePeraGraphEndPoint(value: string): void {\n        this.singlePeraGraphEndPoint = value;\n    }\n\n    public getSinglePeraGraphEndPoint(): string {\n        if (!this.singlePeraGraphEndPoint) {\n            console.warn('Single PeraGraph endpoint is not set!');\n        }\n        return this.singlePeraGraphEndPoint;\n    }\n\n    public setAllPeraGraphsEndPoint(value: string): void {\n        this.allPeraGraphsEndPoint = value;\n    }\n\n    public getAllPeraGraphsEndPoint(): string {\n        if (!this.allPeraGraphsEndPoint) {\n            console.warn('All PeraGraph endpoint is not set!');\n        }\n        return this.allPeraGraphsEndPoint;\n    }\n}\n","import {Injectable} from '@angular/core';\nimport {HttpClient} from '@angular/common/http';\nimport {BehaviorSubject, Observable, timer} from 'rxjs';\nimport {PeraGraph} from '../../../model/PeraGraph';\nimport {switchMap} from 'rxjs/operators';\nimport {PeragraphConfigService} from '../config/peragraph-config.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class PeragraphApiService {\n\n    private readonly _peraGraphSubject: BehaviorSubject<Array<PeraGraph>>;\n    private pollInstance$: Observable<any>;\n\n    constructor(private http: HttpClient,\n                private peragraphConfigService: PeragraphConfigService) {\n        this.pollInstance$ = timer(0, 60000);\n        this._peraGraphSubject = new BehaviorSubject<Array<PeraGraph>>([]);\n    }\n\n    public getPeraGraphSubject() {\n        return this._peraGraphSubject;\n    }\n\n    public getSinglePeragraph(): Observable<PeraGraph> {\n        return this.http.get<PeraGraph>(this.peragraphConfigService.getSinglePeraGraphEndPoint());\n    }\n\n    public getAllPeragraphs(): Observable<any> {\n        return this.http.get(this.peragraphConfigService.getAllPeraGraphsEndPoint());\n    }\n\n    public getPeraGraphInterval() {\n        // Make an HTTP call on an interval\n        return this.pollInstance$.pipe(\n            switchMap(() => this.getAllPeragraphs()));\n\n        /*\n         TODO Have a different method with the filtering criteria, using the same subject,\n         and call it when the filter changes. Then we push the change.\n\n         Do the same thing with sorting.\n         */\n    }\n\n}\n","import {Injectable} from '@angular/core';\nimport {PeraGraph} from '../model/PeraGraph';\nimport {DateService} from './date.service';\nimport * as moment_ from 'moment-timezone';\n\n// The JavaScript compiler gives a weird \"moment cannot be used as a namespace\" type of error\n// This is the workaround...\nconst moment = moment_;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class PatientService {\n\n  constructor(public dateService: DateService) {\n  }\n\n  /**\n   * Returns the patient age in years, months using the patient DOB\n   */\n  public getPatientAge(graph: PeraGraph): string {\n    if (graph && graph.patient && graph.patient.dob) {\n      const daysOld = Math.floor(\n        Math.round((this.dateService.translateDate(moment.utc().valueOf(), graph.timeZone) - graph.patient.dob) / 86400000));\n\n      const d = 'd';\n      const w = 'w';\n      const m = 'm';\n      const y = 'y';\n\n      if (daysOld < 7) {\n        return Math.floor(daysOld) + d;\n      } else if (daysOld >= 7 && daysOld < 31) {\n        return Math.floor(daysOld / 7) + w + Math.floor(daysOld % 7) + d;\n      } else if (daysOld >= 31 && daysOld < 365) {\n        return Math.floor(daysOld / 29.7) + m + Math.floor((daysOld % 29.7) / 7) + w;\n      } else if (daysOld >= 365 && daysOld < 730) {\n        return Math.floor(daysOld / 365) + y + Math.floor((daysOld % 365) / 29.7) + m;\n      } else {\n        return Math.floor(daysOld / 365) + y;\n      }\n    } else {\n      return ' ';\n    }\n  }\n\n\n}\n","import {Injectable} from '@angular/core';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class CommonService {\n\n    /**\n     * Parse any primitive value (string, number, boolean, undefined or null) to a boolean true or false.\n     * @param value Value to parse.\n     */\n    public primitiveToBoolean(value?: string | number | boolean | null): boolean {\n        if (value == null) {\n            return false;\n        }\n\n        if (value === 'true' || value === 'True' || value === 'TRUE') {\n            return true;\n        }\n\n        return typeof value === 'string'\n            ? !!+value   // we parse string to number first\n            : !!value;\n    }\n}\n","import {Injectable} from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class TranslationsService {\n\n  translations = [];\n\n  private keyTranslations = {\n    'ACTIVE': 'perahealth.translation.ACTIVE',\n    'DATA_UPDATED': 'perahealth.translation.DATA_UPDATED',\n    'ELAPSED': 'perahealth.translation.ELAPSED',\n    'OVERRIDDEN': 'perahealth.translation.OVERRIDDEN',\n    'RESUMED': 'perahealth.translation.RESUMED',\n    'V': 'perahealth.translation.VH',\n    'H': 'perahealth.translation.H',\n    'M': 'perahealth.translation.M',\n    'N': 'perahealth.translation.N'\n  };\n\n  constructor() {\n  }\n\n  getTranslation(key: string): string {\n    return (key) ? this.translations[key] : '';\n  }\n\n  public getKeyTranslation(key: string): string {\n    return (key) ? this.translations[this.keyTranslations[key]] : '';\n  }\n}\n","import {Injectable} from '@angular/core';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class TranslationsConfigService {\n\n    private translationsEndPoint: string = null;\n\n    public setTranslationsEndPoint(value: string): void {\n        this.translationsEndPoint = value;\n    }\n\n    public getTranslationsEndpoint(): string {\n        if (!this.translationsEndPoint) {\n            console.warn('Translations endpoint is not set!');\n        }\n        return this.translationsEndPoint;\n    }\n}\n","import {Injectable} from '@angular/core';\nimport {Observable} from 'rxjs';\nimport {HttpClient} from '@angular/common/http';\nimport {TranslationsConfigService} from '../config/translations-config.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class TranslationsApiService {\n\n    constructor(private http: HttpClient,\n                private translationsConfigService: TranslationsConfigService) {\n    }\n\n    getAllTranslations(): Observable<any> {\n        return this.http.get<any>(this.translationsConfigService.getTranslationsEndpoint());\n    }\n\n}\n","import {Injectable} from '@angular/core';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class DiagnosisConfigService {\n\n    private primaryDiagnosesEndpoint: string = null;\n\n    public getPrimaryDiagnosesEndpoint(): string {\n        if (!this.primaryDiagnosesEndpoint) {\n            console.warn('Primary diagnoses endpoint is not set!');\n        }\n        return this.primaryDiagnosesEndpoint;\n    }\n\n    public setPrimaryDiagnosesEndpoint(value: string): void {\n        this.primaryDiagnosesEndpoint = value;\n    }\n}\n","import {Injectable} from '@angular/core';\nimport {DiagnosisConfigService} from '../config/diagnosis-config.service';\nimport {HttpClient} from '@angular/common/http';\nimport {BehaviorSubject, Observable, timer} from 'rxjs';\nimport {switchMap} from 'rxjs/operators';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DiagnosisApiService {\n\n  // The timer that fires so that clients can get the latest diagnoses\n  private pollInstance$: Observable<any>;\n  // Map of primary diagnosis keyed by visit ID\n  private readonly diagnosesSubject: BehaviorSubject<Map<number, string>>;\n\n  constructor(private http: HttpClient, private diagnosisConfigService: DiagnosisConfigService) {\n    this.pollInstance$ = timer(0, 60000);\n    this.diagnosesSubject = new BehaviorSubject<Map<number, string>>(null);\n  }\n\n  public getDiagnosesSubject() {\n    return this.diagnosesSubject;\n  }\n\n  public getDiagnosesSubjectValue() {\n    return this.diagnosesSubject.value;\n  }\n\n  public getAllDiagnoses(): Observable<any> {\n    return this.http.get(this.diagnosisConfigService.getPrimaryDiagnosesEndpoint(), {observe: 'response'});\n  }\n\n  public getPrimaryDiagnosesInterval() {\n    // Make an HTTP call on an interval\n    return this.pollInstance$.pipe(\n      switchMap(() => this.getAllDiagnoses())\n    );\n  }\n}\n","import {Injectable} from '@angular/core';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class TokenConfigService {\n    private checkTokenEndPoint: string = null;\n    private refreshTokenEndPoint: string = null;\n    private getTokenEndPoint: string = null;\n\n    public setCheckTokenEndPoint(value: string): void {\n        this.checkTokenEndPoint = value;\n    }\n\n    public getCheckTokenEndPoint(): string {\n        if (!this.checkTokenEndPoint) {\n            console.warn('Check token endpoint is not set!');\n        }\n        return this.checkTokenEndPoint;\n    }\n\n    public setRefreshTokenEndPoint(value: string): void {\n        this.refreshTokenEndPoint = value;\n    }\n\n    public getRefreshTokenEndPoint(): string {\n        if (!this.refreshTokenEndPoint) {\n            console.warn('Refresh token endpoint is not set!');\n        }\n        return this.refreshTokenEndPoint;\n    }\n\n    public setGetTokenEndPoint(value: string): void {\n        this.getTokenEndPoint = value;\n    }\n\n    public getGetTokenEndPoint(): string {\n        if (!this.getTokenEndPoint) {\n            console.warn('Get token endpoint is not set!');\n        }\n        return this.getTokenEndPoint;\n    }\n}\n","export class User {\n  username: string = null;\n  password: string = null;\n  firstname: string = null;\n  lastname: string = null;\n  appid: string = null;\n  roles: Array<string> = null;\n}\n","import {Injectable} from '@angular/core';\nimport {HttpClient} from '@angular/common/http';\nimport {User} from '../../../model/User';\nimport {TokenConfigService} from '../config/token-config.service';\nimport {Storage} from '@ionic/storage';\nimport {first} from 'rxjs/operators';\nimport {JwtHelperService} from '@auth0/angular-jwt';\nimport {Subject} from 'rxjs';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class TokenApiService {\n    private jwtTokenName = 'jwt_token';\n    // Make the appId available to other services\n    private appId: string = null;\n\n    private deviceToken: string = null;\n\n    // Used to report when a token has been retrieved from storage\n    public readonly token$: Subject<string> = new Subject<string>();\n\n    constructor(private http: HttpClient,\n                private jwtHelper: JwtHelperService,\n                private config: TokenConfigService,\n                private storage: Storage) {\n    }\n\n    /**\n     * Check the current token.\n     */\n    public checkToken() {\n        this.token$.pipe(first()).subscribe((token: string) => {\n            const decodedToken = this.jwtHelper.decodeToken(token);\n            if (decodedToken) {\n                // Convert to a user object to send to the REST service\n                const user = new User();\n                user.username = decodedToken['sub'];\n                user.roles = decodedToken['roles'];\n                user.firstname = decodedToken['firstname'];\n                user.lastname = decodedToken['lastname'];\n                user.appid = decodedToken['appid'];\n\n                // console.log('Existing, valid client side token found. Checking the server.');\n                this.http.post(this.config.getCheckTokenEndPoint(), user).pipe(first()).subscribe(() => {\n                    // If we land in here, then the token interceptor on the server validated the token\n                    this.appId = user.appid;\n                    // console.log('Valid token!');\n                    this.token$.next(token);\n                }, (e) => {\n                    this.appId = null;\n                    // console.log('Invalid token!');\n                    this.token$.next(null);\n                });\n            } else {\n                // console.log('Removing invalid token from storage.');\n                this.clearToken();\n                this.token$.next(null);\n            }\n        });\n        this.getExistingToken();\n    }\n\n    /**\n     * Refresh the token for the given user.\n     *\n     * @param user User for which to refresh token.\n     */\n    public refreshToken(user: User) {\n        if (!user || !user.username) {\n            // console.log('Valid user not supplied, cannot refresh token!');\n        } else {\n            setTimeout(() => {\n                this.token$.pipe(first()).subscribe((token: string) => {\n                    // Check whether or not the token is valid according to the server\n                    this.http.post(this.config.getRefreshTokenEndPoint(), user, {responseType: 'text'}).pipe(first()).subscribe((token: string) => {\n                            // console.log('Successfully retrieved updated token [' + token + ']');\n                            this.storage.set(this.jwtTokenName, token)\n                        },\n                        () => {\n                            // The server thinks the token is not valid (expired, the secret key changed, etc)\n                            // console.log('Invalid token!');\n                            this.clearToken();\n                            this.token$.next(null);\n                        });\n                });\n                this.getExistingToken();\n            }, 100);\n        }\n    }\n\n    public getToken(user: User) {\n        // Check whether or not the token is valid according to the server\n        this.http.post(this.config.getGetTokenEndPoint(), user, {responseType: 'text'}).pipe(first()).subscribe((token: string) => {\n                // console.log('Successfully retrieved new token: [' + token + ']');\n                this.appId = user.appid;\n                this.storage.set(this.jwtTokenName, token)\n                    .then(() => {\n                        // console.log('New token added to storage. [' + token + ']')\n                        this.token$.next(token);\n                    }, () => {\n                        // console.log('Could not store new token!');\n                        this.token$.next(null);\n                    });\n            },\n            (e) => {\n                // The server thinks the token is not valid (expired, the secret key changed, etc)\n                // console.log('Could not retrieve new token!');\n                this.token$.next(null);\n            });\n    }\n\n    public clearToken() {\n        this.storage.remove(this.jwtTokenName)\n            .then((jwt: string) => {\n                // console.log('JWT removed from storage');\n            }, (reason: any) => {\n                // console.log('JWT could not be removed from storage. Reason = ' + reason);\n            });\n    }\n\n    public getExistingToken() {\n        this.storage.get(this.jwtTokenName)\n            .then((token: string) => {\n                this.token$.next(token);\n            }, (error) => {\n                this.token$.next(null);\n            })\n            .catch((error) => {\n                this.token$.next(null);\n            });\n    }\n\n    public getAppId(): string {\n        return this.appId;\n    }\n}\n","import {Injectable} from '@angular/core';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class LocationsConfigService {\n    private activeFacilitiesEndpoint: string = null;\n    private activeUnitsEndpoint: string = null;\n\n    public getActiveFacilitiesEndpoint(): string {\n        if (!this.activeFacilitiesEndpoint) {\n            console.warn('Active facilities endpoint is not set!');\n        }\n        return this.activeFacilitiesEndpoint;\n    }\n\n    public setActiveFacilitiesEndpoint(value: string): void {\n        this.activeFacilitiesEndpoint = value;\n    }\n\n    public getActiveUnitsEndpoint(): string {\n        if (!this.activeUnitsEndpoint) {\n            console.warn('Active units endpoint is not set!');\n        }\n        return this.activeUnitsEndpoint;\n    }\n\n    public setActiveUnitsEndpoint(value: string): void {\n        this.activeUnitsEndpoint = value;\n    }\n}\n","import {Facility} from './Facility';\nimport {Unit} from './Unit';\n\nexport class Locations {\n  public facilities: Facility[] = [];\n  public units: Unit[] = [];\n}\n","import {Injectable, OnDestroy} from '@angular/core';\nimport {Unit} from '../../../model/Unit';\nimport {Facility} from '../../../model/Facility';\nimport {HttpClient} from '@angular/common/http';\nimport {LocationsConfigService} from '../config/locations-config.service';\nimport {Observable, Subject, Subscription} from 'rxjs';\nimport {map} from 'rxjs/operators';\nimport {Locations} from '../../../model/Locations';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class LocationsApiService implements OnDestroy {\n\n  private facilitySubscription: Subscription;\n  private unitSubscription: Subscription;\n\n  public readonly facilitiesAndUnit$: Subject<{ facilities: Facility[], units: Unit[] }>;\n\n  private locations: Locations = new Locations();\n\n  constructor(\n    private http: HttpClient,\n    private locationsConfigService: LocationsConfigService) {\n    this.facilitiesAndUnit$ = new Subject<{ facilities: Facility[], units: Unit[] }>();\n  }\n\n  /**\n   * Updates facilities and units and calls the facilitiesAndUnitSubject when it completes.\n   * Will use a cache if they were previously retrieved.\n   */\n  public getFacilitiesAndUnits() {\n    if (this.locations.facilities && this.locations.facilities.length > 0 && this.locations.units && this.locations.units.length > 0) {\n      this.facilitiesAndUnit$.next(this.locations);\n    } else {\n      /** Receive all facilities and active units and set instance variables for caching */\n      this.facilitySubscription = this.getActiveFacilities().pipe(map((f) => f.facilities)).subscribe((facilities: Facility[]) => {\n        if (facilities && facilities.length > 0) {\n          const facilityIds: String[] = [];\n          for (const facility of facilities) {\n            facilityIds.push(facility.facilityID);\n          }\n          this.unitSubscription = this.getActiveUnitsForFacilities(facilityIds).pipe((map((u) => u.units))).subscribe((units: Unit[]) => {\n            // filter out facilities with no active units\n            this.locations = new Locations();\n            for (const f of facilities) {\n              let hasActiveUnits = false;\n              for (const u of units) {\n                if (u.key.facilityID === f.facilityID) {\n                  hasActiveUnits = true;\n                  break;\n                }\n              }\n              if (hasActiveUnits) {\n                this.locations.facilities.push(f);\n              }\n            }\n            this.locations.units = units;\n            this.facilitiesAndUnit$.next(this.locations);\n          }, (e) => {\n            console.log('Could not update units! Error = ' + e.message);\n          });\n        }\n      }, (e) => {\n        console.log('Could not update facilities! Error = ' + e.message);\n      });\n    }\n  }\n\n  getActiveFacilities(): Observable<{ facilities: Array<Facility> }> {\n    console.log('Getting all facilities: ' + this.locationsConfigService.getActiveFacilitiesEndpoint());\n    return this.http.get<{ facilities: Array<Facility> }>(this.locationsConfigService.getActiveFacilitiesEndpoint());\n  }\n\n  getActiveUnitsForFacilities(facilities: String[]): Observable<{ units: Array<Unit> }> {\n    console.log('Getting all active units: ' + this.locationsConfigService.getActiveUnitsEndpoint() + facilities);\n    return this.http.get<{ units: Array<Unit> }>(this.locationsConfigService.getActiveUnitsEndpoint() + facilities);\n  }\n\n  ngOnDestroy(): void {\n    if (this.facilitySubscription && !this.facilitySubscription.closed) {\n      this.facilitySubscription.unsubscribe();\n    }\n    if (this.unitSubscription && !this.unitSubscription.closed) {\n      this.unitSubscription.unsubscribe();\n    }\n  }\n}\n","import {Injectable} from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UsageConfigService {\n  private usageDataEndPoint: string;\n  // Default to polling every 5 seconds\n  private usagePollingInterval = 5000;\n\n  /** @param value Endpoint for sending usage data. */\n  public setUsageDataEndPoint(value: string): void {\n    this.usageDataEndPoint = value;\n  }\n\n  /** Endpoint for sending usage data. */\n  public getUsageDataEndPoint(): string {\n    if (!this.usageDataEndPoint) {\n      console.warn('usage data endpoint is not set!');\n    }\n    return this.usageDataEndPoint;\n  }\n\n  /** Number of milliseconds between polling attempts. */\n  public getUsagePollingInterval(): number {\n    return this.usagePollingInterval;\n  }\n\n  /** @param value Number of milliseconds between polling attempts. */\n  public setUsagePollingInterval(value: number): void {\n    this.usagePollingInterval = value;\n  }\n}\n","export class PatientAccess {\n  public viewedBy: string;\n  public patient: string;\n  public vipIndicator: string;\n  public vnm: string;\n  public mrn: string;\n  public admitDate: number;\n  public dischargeDate: number;\n  public facilityId: string;\n  public unitId: string;\n  public provider: string;\n  public utcCode: string;\n  public usageCode: string;\n  public viewDate: number;\n\n\n  constructor(viewedBy: string,\n              patient: string,\n              vipIndicator: string,\n              vnm: string,\n              mrn: string,\n              admitDate: number,\n              dischargeDate: number,\n              facilityId: string,\n              unitId: string,\n              provider: string,\n              utcCode: string,\n              usageCode: string,\n              viewDate: number) {\n    this.viewedBy = viewedBy;\n    this.patient = patient;\n    this.vipIndicator = vipIndicator;\n    this.vnm = vnm;\n    this.mrn = mrn;\n    this.admitDate = admitDate;\n    this.dischargeDate = dischargeDate;\n    this.facilityId = facilityId;\n    this.unitId = unitId;\n    this.provider = provider;\n    this.utcCode = utcCode;\n    this.usageCode = usageCode;\n    this.viewDate = viewDate;\n  }\n}\n","export enum UsageType {\n  Array = 'U',\n  Graph = 'G'\n}\n","import {Injectable} from '@angular/core';\nimport {HttpClient} from '@angular/common/http';\nimport {BehaviorSubject, Observable, of, Subject, Subscription, timer} from 'rxjs';\nimport {TokenApiService} from '../../token/api/token-api.service';\nimport {PatientAccess} from '../../../model/PatientAccess';\nimport {UsageType} from '../../../model/UsageType';\nimport {PeraGraph} from '../../../model/PeraGraph';\nimport {JwtHelperService} from '@auth0/angular-jwt';\nimport {UsageConfigService} from '../config/usage-config.service';\nimport {first, map, tap} from 'rxjs/operators';\nimport * as moment_ from 'moment-timezone';\nimport {LocationsApiService} from '../../locations/api/locations-api.service';\nimport {Locations} from \"../../../model/Locations\";\n\n// The JavaScript compiler gives a weird \"moment cannot be used as a namespace\" type of error\n// This is the workaround...\nconst moment = moment_;\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class UsageApiService {\n\n    public usageDataAdded$: Subject<PatientAccess>;\n    private pollInstance$: Observable<any>;\n    private readonly graphUpdated$: Subject<PeraGraph>;\n    private usageData: Array<PatientAccess> = new Array<PatientAccess>();\n    // Visits that have been viewed in the array view are only added to usageData once per session\n    private viewedVisits: string[] = [];\n    private initialized = false;\n    private locations: Locations;\n    private locationsLoaded$: Subject<boolean> = new Subject<boolean>();\n    private locationsLoaded: boolean = false;\n    private startedLoadingLocations = false;\n\n    // The token service is necessary to get the appId\n    constructor(private http: HttpClient,\n                private jwtHelper: JwtHelperService,\n                private usageConfigService: UsageConfigService,\n                private locationService: LocationsApiService,\n                private tokenApiService: TokenApiService) {\n        this.graphUpdated$ = new Subject<PeraGraph>();\n        this.usageDataAdded$ = new Subject<PatientAccess>();\n    }\n\n    public init() {\n        if (!this.initialized) {\n            this.initialized = true;\n        }\n    }\n\n    public startUsageReportingService(): void {\n        this.pollInstance$ = timer(0, this.usageConfigService.getUsagePollingInterval());\n        this.pollInstance$.subscribe(() => {\n            if (this.usageData && this.usageData.length > 0) {\n                this.submitUsageData();\n            }\n        });\n        if (this.usageData && this.usageData.length > 0) {\n            // Submit now in case the user closes the window before the timer fires\n            this.submitUsageData();\n        }\n        // get all the locations when the service is initialized\n        this.locationService.facilitiesAndUnit$.pipe(first()).subscribe((locations: Locations) => {\n            this.locations = locations;\n            this.locationsLoaded = true;\n            this.locationsLoaded$.next(true);\n        });\n        this.locationService.getFacilitiesAndUnits();\n    }\n\n    public submitUsageData(): void {\n        console.log('Submitting usage data for app ' + this.tokenApiService.getAppId() + ' Size = ' + this.usageData.length);\n        const usageDataCopy = this.usageData.slice();\n        this.usageData = [];\n        this.http.post(this.usageConfigService.getUsageDataEndPoint(), usageDataCopy).pipe(first()).subscribe();\n    }\n\n    /**\n     * When the user logs out of the system, we need to clear the cache\n     * so that the graph views are sent if they log in again.\n     */\n    public clearUsageCache(): void {\n        this.viewedVisits = [];\n    }\n\n    /**\n     * Add usage data.\n     * @param graphToLog The information that was viewed.\n     * @param usageType The context in which the information was viewed.\n     */\n    public addUsageData(graphToLog: PeraGraph, usageType: UsageType): void {\n        // We have to replace the facility and unit IDs with the real deals\n        this.updateFacilityAndUnitIdsForGraph(graphToLog).pipe(first(), tap((graph: PeraGraph) => {\n            this.tokenApiService.token$.pipe(first()).subscribe((token: string) => {\n                if (usageType === UsageType.Array) {\n                    // Only log 1 graph view per session when viewed in the array view\n                    if (graph && this.viewedVisits.indexOf(graph.vnm) < 0) {\n                        // We only log 1 visit view of a specific type per session\n                        this.viewedVisits.push(graph.vnm);\n                        this.addUsageDataFromToken(graph, usageType, token);\n                    }\n                } else {\n                    // Always add graph views because the user clicked on a graph in the array view\n                    this.addUsageDataFromToken(graph, usageType, token);\n                }\n            });\n            this.tokenApiService.getExistingToken();\n        })).subscribe();\n        if (!this.locationsLoaded && !this.startedLoadingLocations) {\n            this.startedLoadingLocations = true;\n            this.locationService.getFacilitiesAndUnits();\n        }\n    }\n\n    /**\n     * lookup and insert the unit id and fac id of graph to log\n     * @param graph - graph to log\n     */\n    private updateFacilityAndUnitIdsForGraph(graph: PeraGraph): Observable<PeraGraph> {\n        // Create a clone of the original graph since we are updating the facility and unit\n        // to their original IDs for Usage.\n        const cloneGraph: PeraGraph = JSON.parse(JSON.stringify(graph));\n        if (this.locationsLoaded === true) {\n            return of(UsageApiService.assignUnitAndFacIdToPeraGraph(cloneGraph, this.locations));\n        } else {\n            return this.locationsLoaded$.pipe(map(() => {\n                return UsageApiService.assignUnitAndFacIdToPeraGraph(cloneGraph, this.locations);\n            }));\n        }\n    }\n\n    /**\n     * helper method for looking up fac and unit ids\n     * @param graph - graph to replace unitId and facId of\n     * @param locations - all locations available to search\n     */\n    private static assignUnitAndFacIdToPeraGraph(graph: PeraGraph, locations: Locations): PeraGraph {\n        for (const fac of locations.facilities) {\n            if (graph.facilityId === fac.displayName) {\n                graph.facilityId = fac.facilityID;\n                break;\n            }\n        }\n        for (const unit of locations.units) {\n            if (graph.unitId === unit.displayName) {\n                graph.unitId = unit.key.unitID;\n                break;\n            }\n        }\n        return graph;\n    }\n\n    private addUsageDataFromToken(graph: PeraGraph, usageType: UsageType, token: string): void {\n        const decodedToken = this.jwtHelper.decodeToken(token);\n        if (decodedToken) {\n            // Convert to a user object to send to the REST service\n            const pa: PatientAccess = new PatientAccess(\n                decodedToken['sub'], // The claims subject is the username\n                graph.patient.lname + ', ' + graph.patient.fname,\n                graph.vipIndicator,\n                graph.vnm,\n                graph.patient.medicalRecordNumber,\n                graph.admitDate,\n                graph.dischargeDate,\n                graph.facilityId,\n                graph.unitId,\n                graph.attendingProvider.lastName + ', ' + graph.attendingProvider.firstName,\n                graph.visitUnitType,\n                usageType,\n                moment.valueOf()\n            );\n            this.usageData.push(pa);\n            // This can be used for testing and for the timing of individual calls to submitUsageData()\n            this.usageDataAdded$.next(pa);\n        }\n    }\n}\n","export class Facility {\n\n  public active: number;\n  public facilityID: string;\n  public displayName: string;\n  public displayOrder: number;\n  public facilityTimezone: string;\n  public fullName: String;\n  public primaryType: String;\n  public secondaryType: String;\n\n\n    constructor(active: number, facilityID: string, displayName: string, displayOrder: number, facilityTimezone: string, fullName: String, primaryType: String, secondaryType: String) {\n        this.active = active;\n        this.facilityID = facilityID;\n        this.displayName = displayName;\n        this.displayOrder = displayOrder;\n        this.facilityTimezone = facilityTimezone;\n        this.fullName = fullName;\n        this.primaryType = primaryType;\n        this.secondaryType = secondaryType;\n    }\n}\n","import {UnitKey} from './UnitKey';\n\nexport class Unit {\n\n  public key: UnitKey;\n  public displayName: string;\n  public utcCode: any;\n\n  constructor(key: UnitKey, displayName: string, utcCode: any) {\n    this.key = key;\n    this.displayName = displayName;\n    this.utcCode = utcCode;\n  }\n}\n","export class UnitKey {\n\n    public facilityID: string;\n    public unitID: string;\n\n    constructor(fid: string, uid: string) {\n        this.facilityID = fid;\n        this.unitID = uid;\n    }\n}\n"],"names":["moment"],"mappings":"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"}
